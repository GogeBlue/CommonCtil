# 格式字符串规则

## 一、综述

此规则适用于本项目（CommonCtil）中所有涉及到格式字符串的函数。同时，此规则兼容标准CRT库中的格式字符串，所以遵循CRT库规则的格式字符串可以直接在本项目中使用。

## 二、规则详解

### （一）整体结构

`%[sign][padding][precision][iteration][size](type)`

注：[]代表可缺省，()代表必填，括号外为固定字符，括号内为字段名称

### （二）sign字段

#### 1. 含义

如果该数据类型为有符号类型，指定正数是否在数字前面加正号。

#### 2. 字段说明

| 类型 | "+"                        | 空                           |
| ---- | -------------------------- | ---------------------------- |
| b, B | 不输出符号                 | 不输出符号                   |
| o, O | 不输出符号                 | 不输出符号                   |
| d, D | 正数输出正号，负数输出负号 | 正数不输出符号，负数输出负号 |
| u, U | 不输出符号                 | 不输出符号                   |
| x, X | 不输出符号                 | 不输出符号                   |
| f, F | 正数输出正号，负数输出负号 | 正数不输出符号，负数输出负号 |
| e, E | 正数输出正号，负数输出负号 | 正数不输出符号，负数输出负号 |
| g, G | 正数输出正号，负数输出负号 | 正数不输出符号，负数输出负号 |
| c, C | 不输出符号                 | 不输出符号                   |
| s, S | 不输出符号                 | 不输出符号                   |

### （三）padding字段

#### 1. 含义

指定该数据的输出字符串的最小长度，以及在最小长度无法达到的情况下的填充模式。

#### 2. 组成

`[align][content](length)`

#### 3. align字段说明

| 类型     | "-"    | 空     |
| -------- | ------ | ------ |
| 所有类型 | 左对齐 | 右对齐 |

#### 4. content字段说明

| 类型 | "0"                                    | 空       |
| ---- | -------------------------------------- | -------- |
| b, B | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| o, O | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| d, D | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| u, U | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| x, X | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| f, F | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| e, E | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| g, G | align为"-"，填充空格；align为空，填充0 | 填充空格 |
| c, C | 填充空格                               | 填充空格 |
| s, S | 填充空格                               | 填充空格 |

#### 5. length字段说明

| 类型     | 正整数                                                       | "*"                  |
| -------- | ------------------------------------------------------------ | -------------------- |
| 所有类型 | 对应输出字符串长度最少为该数，如果不够，则按照指定的规则填充 | 该字段由参数列表提供 |

### （四）precision字段

#### 1. 含义

对于数字类数据，指定其精度；对于字符类数据，指定其最大长度。

#### 2. 组成

`.[flag](value)`

#### 3. flag字段说明

| 类型 | "="                                     | 空                                      |
| ---- | --------------------------------------- | --------------------------------------- |
| b, B | 保留最低的value位数字（从右往左数）     | 保留最低的value位数字（从右往左数）     |
| o, O | 保留最低的value位数字（从右往左数）     | 保留最低的value位数字（从右往左数）     |
| d, D | 保留value位有效数字                     | 保留value位有效数字                     |
| u, U | 保留value位有效数字                     | 保留value位有效数字                     |
| x, X | 保留最低的value位数字（从右往左数）     | 保留最低的value位数字（从右往左数）     |
| f, F | 保留value位有效数字                     | 小数点后保留value位数字                 |
| e, E | 保留value位有效数字                     | 小数点后保留value位数字                 |
| g, G | 保留value位有效数字                     | 小数点后保留value位数字                 |
| c, C | 最大输出长度为value个字符，超出停止输出 | 最大输出长度为value个字符，超出停止输出 |
| s, S | 最大输出长度为value个字符，超出停止输出 | 最大输出长度为value个字符，超出停止输出 |

#### 4. value字段说明

| 类型     | 正整数                                   | "*"                  |
| -------- | ---------------------------------------- | -------------------- |
| 所有类型 | 指定精度数为该数，按照指定的规则保留数据 | 该字段由参数列表提供 |

### （五）iteration字段

#### 1.含义

遍历数组（数据空间），循环输出数据。

#### 2. 组成

`r(length)[-(group size)[-(row size)]]`

#### 3. length字段说明

| 类型     | 正整数               | "*"                  |
| -------- | -------------------- | -------------------- |
| 所有类型 | 输出数据的数量为该数 | 该字段由参数列表提供 |

#### 4. group size字段说明

| 类型     | 正整数                                              | "*"                  |
| -------- | --------------------------------------------------- | -------------------- |
| 所有类型 | 数量为该数的数据会被分为一组，每组之间由1个空格分隔 | 该字段由参数列表提供 |

#### 5. row size字段说明

| 类型     | 正整数                                              | "*"                  |
| -------- | --------------------------------------------------- | -------------------- |
| 所有类型 | 数量为该数的组会被分为一行，每行之间由1个'\r\n'分隔 | 该字段由参数列表提供 |

### （六）size字段

#### 1. 含义

对于数字类数据，指定其字节数；对于字符类数据，指定其字符编码。

#### 2. 字段说明

| 类型 | "hh" | "h"   | "l"    | "ll"                                             | 空    |
| ---- | ---- | ----- | ------ | ------------------------------------------------ | ----- |
| b, B | 8位  | 16位  | 32位   | CMT_ENV_x86模式下为32位；CMT_ENV_x64模式下为64位 | 32位  |
| o, O | 8位  | 16位  | 32位   | CMT_ENV_x86模式下为32位；CMT_ENV_x64模式下为64位 | 32位  |
| d, D | 8位  | 16位  | 32位   | CMT_ENV_x86模式下为32位；CMT_ENV_x64模式下为64位 | 32位  |
| u, U | 8位  | 16位  | 32位   | CMT_ENV_x86模式下为32位；CMT_ENV_x64模式下为64位 | 32位  |
| x, X | 8位  | 16位  | 32位   | CMT_ENV_x86模式下为32位；CMT_ENV_x64模式下为64位 | 32位  |
| f, F | 16位 | 32位  | 32位   | 64位                                             | 32位  |
| e, E | 16位 | 32位  | 32位   | 64位                                             | 32位  |
| g, G | 16位 | 32位  | 32位   | 64位                                             | 32位  |
| c, C | ANSI | UTF-8 | UTF-16 | UTF-32                                           | UTF-8 |
| s, S | ANSI | UTF-8 | UTF-16 | UTF-32                                           | UTF-8 |

### （七）type字段

#### 1. 含义

指定该数据的类型。

#### 2. 字段说明

| type字段字符（类型） | 解释                                                         |
| -------------------- | ------------------------------------------------------------ |
| b, B                 | 输出二进制数                                                 |
| o, O                 | 输出八进制数                                                 |
| d, D                 | 输出十进制有符号数                                           |
| u, U                 | 输出十进制无符号数                                           |
| x                    | 输出十六进制数，a-f使用小写                                  |
| X                    | 输出十六进制数，A-F使用大写                                  |
| f, F                 | 输出浮点数                                                   |
| e                    | 使用科学计数法输出浮点数，其中e使用小写，如：1.01e+02        |
| E                    | 使用科学计数法输出浮点数，其中E使用大写，如：1.01E+02        |
| g                    | 如果数据小于10^-4或大于10^*precision.size*，使用科学计数法，e小写，否则正常输出 |
| G                    | 如果数据小于10^-4或大于10^*precision.size*，使用科学计数法，E大写，否则正常输出 |
| c, C                 | 输出字符                                                     |
| s, S                 | 输出字符串（必须使用cmtANSIstr，cmtU8str，cmtU16str以及cmtU32str这四种字符串结构体中的一种作为参数） |

### （八）字段中的"*"

"\*"代表这个字段的值会由参数列表提供。参数的顺序和"\*"出现的顺序一致，且类型必须为cmtUint64类型。
